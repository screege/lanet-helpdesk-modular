# üñ•Ô∏è **ESPECIFICACIONES DEL AGENTE CLIENTE - M√ìDULO ASSET AGENTS**

## **üéØ RESUMEN EJECUTIVO**

El agente cliente es un servicio que se instala en equipos Windows de los clientes MSP para recopilar informaci√≥n del sistema, monitorear estado, y comunicarse con el backend de LANET Helpdesk V3. Los datos recopilados alimentan el **Portal de Activos para Clientes**, permitiendo que los clientes vean sus equipos, inventarios y m√©tricas en tiempo real. Este documento define las especificaciones t√©cnicas completas para su desarrollo.

---

## **üèóÔ∏è ARQUITECTURA DEL AGENTE**

### **üìä Diagrama de Componentes**

```mermaid
graph TB
    subgraph "üñ•Ô∏è Agente Cliente (Windows)"
        CORE[Core Service<br/>Python/Go/C#]
        REG[Registration Module]
        HB[Heartbeat Module]
        MON[Monitoring Module]
        EXEC[Script Executor]
        CONFIG[Config Manager]
        LOG[Logging System]
        DB[Local SQLite DB]
    end
    
    subgraph "üåê Comunicaci√≥n"
        HTTPS[HTTPS/TLS 1.3]
        JWT[JWT Authentication]
        API[REST APIs]
    end
    
    subgraph "üóÑÔ∏è Backend LANET"
        FLASK[Flask Backend]
        POSTGRES[PostgreSQL]
        TOKENS[Token Validation]
    end
    
    CORE --> REG
    CORE --> HB
    CORE --> MON
    CORE --> EXEC
    CORE --> CONFIG
    CORE --> LOG
    CORE --> DB
    
    REG --> HTTPS
    HB --> HTTPS
    MON --> HTTPS
    EXEC --> HTTPS
    
    HTTPS --> JWT
    JWT --> API
    API --> FLASK
    FLASK --> POSTGRES
    FLASK --> TOKENS
```

### **üîß Componentes Principales**

| **Componente** | **Responsabilidad** | **Tecnolog√≠a** |
|----------------|-------------------|----------------|
| **Core Service** | Orquestaci√≥n general, lifecycle management | Python/Go/C# |
| **Registration Module** | Registro inicial con token, obtenci√≥n de JWT | HTTP Client |
| **Heartbeat Module** | Comunicaci√≥n peri√≥dica con backend | Scheduler + HTTP |
| **Monitoring Module** | Recolecci√≥n de m√©tricas del sistema | WMI/PowerShell |
| **Script Executor** | Ejecuci√≥n de comandos remotos | PowerShell/CMD |
| **üÜï System Tray UI** | Interfaz de usuario en bandeja del sistema | pystray + tkinter |
| **üÜï Ticket Creator** | Creaci√≥n de tickets desde el agente | HTTP Client + UI |
| **Config Manager** | Gesti√≥n de configuraci√≥n local | JSON/YAML |
| **Logging System** | Logs locales y env√≠o al backend | File + HTTP |
| **Local Database** | Cache de datos y configuraci√≥n | SQLite |

---

## **üîë PROCESO DE REGISTRO CON TOKEN**

### **üìã Flujo de Registro Inicial**

```mermaid
sequenceDiagram
    participant A as Agente Cliente
    participant B as Backend LANET
    participant D as Base de Datos
    participant T as Tabla Tokens
    
    A->>A: Leer token de instalaci√≥n
    A->>A: Recopilar informaci√≥n del sistema
    A->>B: POST /api/agents/register-with-token
    Note over A,B: {token, hardware_info}
    
    B->>T: Validar token existe y activo
    T-->>B: ‚úÖ Token v√°lido
    
    B->>D: Crear registro en tabla assets
    D-->>B: ‚úÖ Asset creado
    
    B->>T: Incrementar usage_count
    B->>D: Registrar en token_usage_history
    
    B->>B: Generar JWT para agente
    B-->>A: ‚úÖ Registro exitoso + JWT
    Note over B,A: {asset_id, jwt_token, config}
    
    A->>A: Guardar JWT y configuraci√≥n
    A->>A: Iniciar heartbeat peri√≥dico
```

### **üîê Validaci√≥n de Token**

**Formato Esperado:** `LANET-{CLIENT_CODE}-{SITE_CODE}-{RANDOM}`

**Ejemplo:** `LANET-550E-660E-AEB0F9`

**Validaci√≥n en Backend:**
```python
def validate_token_format(token: str) -> bool:
    pattern = r'^LANET-[A-Z0-9]{4}-[A-Z0-9]{4}-[A-Z0-9]{6}$'
    return re.match(pattern, token) is not None
```

**Estados de Token:**
- ‚úÖ **V√°lido:** Token existe, activo, no expirado
- ‚ùå **Inv√°lido:** Token no existe en base de datos
- ‚ùå **Inactivo:** Token desactivado por administrador
- ‚ùå **Expirado:** Token pas√≥ fecha de expiraci√≥n
- ‚ùå **Usado:** Token ya fue usado (si se implementa l√≠mite de uso √∫nico)

---

## **üì° APIs DISPONIBLES PARA EL AGENTE**

### **üîß Endpoint: Registro de Agente**

```http
POST /api/agents/register-with-token
Content-Type: application/json
```

**Request Body:**
```json
{
  "token": "LANET-550E-660E-AEB0F9",
  "hardware_info": {
    "computer_name": "DESKTOP-001",
    "os": "Windows 11 Pro",
    "os_version": "22H2",
    "cpu": "Intel i7-12700K",
    "cpu_cores": 8,
    "cpu_threads": 16,
    "ram": "32GB DDR4",
    "disk": "1TB NVMe SSD",
    "mac_address": "00:11:22:33:44:55",
    "ip_address": "192.168.1.100",
    "domain": "WORKGROUP",
    "serial_number": "ABC123",
    "motherboard": "ASUS Z690-P",
    "bios_version": "v2.1",
    "assigned_user": "Juan P√©rez",
    "department": "Contabilidad",
    "estimated_value": 2500,
    "warranty_expires": "2026-03-15T00:00:00Z",
    "installed_software": [
      {"name": "Microsoft Office", "version": "365", "publisher": "Microsoft"},
      {"name": "Google Chrome", "version": "120.0.6099.109", "publisher": "Google"}
    ],
    "services": [
      {"name": "Windows Update", "status": "running", "startup": "automatic"},
      {"name": "Windows Defender", "status": "running", "startup": "automatic"}
    ]
  }
}
```

**Response (201 Created):**
```json
{
  "success": true,
  "data": {
    "asset_id": "456e7890-e89b-12d3-a456-426614174000",
    "client_id": "550e8400-e29b-41d4-a716-446655440001",
    "site_id": "660e8400-e29b-41d4-a716-446655440001",
    "agent_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "config": {
      "heartbeat_interval": 60,
      "monitoring_enabled": true,
      "auto_ticket_creation": false,
      "allowed_scripts": ["powershell", "batch"],
      "update_schedule": "02:00",
      "log_level": "INFO",
      "backend_url": "https://helpdesk.lanet.mx/api"
    },
    "registered_at": "2025-07-15T21:00:00Z"
  }
}
```

### **üíì Endpoint: Heartbeat**

```http
POST /api/agents/heartbeat
Authorization: Bearer {agent_jwt_token}
Content-Type: application/json
```

**Request Body:**
```json
{
  "asset_id": "456e7890-e89b-12d3-a456-426614174000",
  "status": {
    "cpu_usage": 15.5,
    "memory_usage": 45.2,
    "disk_usage": 85.0,
    "network_usage": 2.3,
    "uptime": 86400,
    "last_boot": "2025-07-14T21:00:00Z",
    "services_status": [
      {"name": "Windows Update", "status": "running"},
      {"name": "Windows Defender", "status": "running"}
    ]
  },
  "alerts": [
    {
      "type": "disk_space",
      "severity": "warning",
      "message": "Disk C: is 85% full",
      "threshold": 80,
      "current_value": 85.0
    }
  ],
  "logs": [
    {
      "timestamp": "2025-07-15T21:04:30Z",
      "level": "INFO",
      "message": "System monitoring completed successfully"
    }
  ]
}
```

**Response (200 OK):**
```json
{
  "success": true,
  "data": {
    "received_at": "2025-07-15T21:05:00Z",
    "next_heartbeat": "2025-07-15T21:06:00Z",
    "commands": [
      {
        "command_id": "cmd-123",
        "type": "script",
        "script": "Get-Service | Where-Object {$_.Status -eq 'Stopped'}",
        "timeout": 30,
        "priority": "normal"
      }
    ],
    "config_updates": {
      "heartbeat_interval": 30,
      "log_level": "DEBUG"
    }
  }
}
```

---

## **üìä ESTRUCTURA DE DATOS ESPERADA**

### **üñ•Ô∏è Hardware Information**

```json
{
  "computer_name": "string",           // Nombre del equipo
  "os": "string",                      // Sistema operativo
  "os_version": "string",              // Versi√≥n del OS
  "cpu": "string",                     // Modelo del procesador
  "cpu_cores": "integer",              // N√∫mero de n√∫cleos
  "cpu_threads": "integer",            // N√∫mero de hilos
  "ram": "string",                     // Memoria RAM total
  "disk": "string",                    // Informaci√≥n de discos
  "mac_address": "string",             // Direcci√≥n MAC principal
  "ip_address": "string",              // Direcci√≥n IP actual
  "domain": "string",                  // Dominio o workgroup
  "motherboard": "string",             // Modelo de motherboard
  "bios_version": "string",            // Versi√≥n del BIOS
  "serial_number": "string"            // N√∫mero de serie del equipo
}
```

### **üíø Software Information**

```json
{
  "installed_software": [
    {
      "name": "string",                // Nombre del programa
      "version": "string",             // Versi√≥n
      "publisher": "string",           // Editor/Fabricante
      "install_date": "string",        // Fecha de instalaci√≥n
      "size": "string"                 // Tama√±o en disco
    }
  ],
  "services": [
    {
      "name": "string",                // Nombre del servicio
      "status": "string",              // running, stopped, paused
      "startup": "string",             // automatic, manual, disabled
      "description": "string"          // Descripci√≥n del servicio
    }
  ],
  "updates": {
    "last_check": "timestamp",         // √öltima verificaci√≥n de updates
    "pending_count": "integer",        // Actualizaciones pendientes
    "last_install": "timestamp",       // √öltima instalaci√≥n
    "auto_update_enabled": "boolean"   // Auto-update activado
  }
}
```

### **üìà System Metrics**

```json
{
  "cpu_usage": "float",               // Porcentaje de uso de CPU
  "memory_usage": "float",            // Porcentaje de uso de RAM
  "disk_usage": "float",              // Porcentaje de uso de disco
  "network_usage": "float",           // Mbps de uso de red
  "uptime": "integer",                // Tiempo encendido en segundos
  "last_boot": "timestamp",           // √öltima vez que se reinici√≥
  "temperature": "float",             // Temperatura del CPU (si disponible)
  "processes_count": "integer",       // N√∫mero de procesos activos
  "threads_count": "integer"          // N√∫mero de hilos activos
}
```

---

## **‚öôÔ∏è CONFIGURACI√ìN DEL AGENTE**

### **üìã Archivo de Configuraci√≥n (agent_config.json)**

```json
{
  "agent": {
    "version": "1.0.0",
    "asset_id": "456e7890-e89b-12d3-a456-426614174000",
    "client_id": "550e8400-e29b-41d4-a716-446655440001",
    "site_id": "660e8400-e29b-41d4-a716-446655440001"
  },
  "backend": {
    "url": "https://helpdesk.lanet.mx/api",
    "timeout": 30,
    "retry_attempts": 3,
    "retry_delay": 5
  },
  "heartbeat": {
    "interval": 60,
    "enabled": true,
    "include_metrics": true,
    "include_logs": true
  },
  "monitoring": {
    "enabled": true,
    "cpu_threshold": 90,
    "memory_threshold": 90,
    "disk_threshold": 85,
    "service_monitoring": true,
    "process_monitoring": false
  },
  "scripts": {
    "enabled": true,
    "allowed_types": ["powershell", "batch"],
    "timeout": 300,
    "max_concurrent": 3
  },
  "logging": {
    "level": "INFO",
    "file_path": "C:\\ProgramData\\LANETAgent\\logs\\agent.log",
    "max_size": "10MB",
    "backup_count": 5,
    "send_to_backend": true
  },
  "security": {
    "verify_ssl": true,
    "jwt_refresh_threshold": 3600,
    "encryption_enabled": true
  }
}
```

### **üîß Configuraci√≥n Din√°mica desde Backend**

El backend puede enviar actualizaciones de configuraci√≥n durante el heartbeat:

```json
{
  "config_updates": {
    "heartbeat_interval": 30,          // Cambiar frecuencia de heartbeat
    "log_level": "DEBUG",              // Cambiar nivel de logging
    "monitoring_enabled": false,       // Desactivar monitoreo
    "cpu_threshold": 95,               // Cambiar umbral de CPU
    "auto_ticket_creation": true       // Activar creaci√≥n autom√°tica de tickets
  }
}
```

---

## **üîê AUTENTICACI√ìN Y SEGURIDAD**

### **üé´ JWT Token Structure para Agente**

```json
{
  "asset_id": "456e7890-e89b-12d3-a456-426614174000",
  "client_id": "550e8400-e29b-41d4-a716-446655440001",
  "site_id": "660e8400-e29b-41d4-a716-446655440001",
  "computer_name": "DESKTOP-001",
  "type": "agent",
  "exp": 1721073600,                  // Expiraci√≥n (24 horas)
  "iat": 1721070000                   // Issued at
}
```

### **üîí Medidas de Seguridad**

1. **Comunicaci√≥n Encriptada:** Todas las comunicaciones via HTTPS/TLS 1.3
2. **Validaci√≥n de Certificados:** Verificar certificados SSL del backend
3. **JWT Refresh:** Renovar tokens antes de expiraci√≥n
4. **Rate Limiting:** Respetar l√≠mites de API calls
5. **Local Encryption:** Encriptar datos sensibles en disco
6. **Audit Trail:** Registrar todas las acciones del agente

---

## **üìã REQUERIMIENTOS T√âCNICOS**

### **üñ•Ô∏è Requisitos del Sistema**

| **Componente** | **M√≠nimo** | **Recomendado** |
|----------------|------------|-----------------|
| **OS** | Windows 10 | Windows 11 |
| **RAM** | 512 MB | 1 GB |
| **Disco** | 100 MB | 500 MB |
| **CPU** | 1 GHz | 2 GHz |
| **Red** | 1 Mbps | 10 Mbps |
| **.NET Framework** | 4.7.2 | 4.8 |
| **PowerShell** | 5.1 | 7.0+ |

### **üîß Dependencias de Software**

```json
{
  "python_dependencies": [
    "requests>=2.28.0",
    "psutil>=5.9.0",
    "schedule>=1.2.0",
    "cryptography>=3.4.8",
    "pywin32>=304",
    "wmi>=1.5.1"
  ],
  "system_dependencies": [
    "Windows Management Instrumentation (WMI)",
    "PowerShell 5.1+",
    "Windows Event Log API",
    "Performance Counters API"
  ]
}
```

### **üì¶ Estructura de Instalaci√≥n**

```
C:\Program Files\LANET Agent\
‚îú‚îÄ‚îÄ bin\
‚îÇ   ‚îú‚îÄ‚îÄ agent.exe                    # Ejecutable principal
‚îÇ   ‚îú‚îÄ‚îÄ agent-service.exe            # Servicio de Windows
‚îÇ   ‚îî‚îÄ‚îÄ uninstall.exe               # Desinstalador
‚îú‚îÄ‚îÄ config\
‚îÇ   ‚îú‚îÄ‚îÄ agent_config.json           # Configuraci√≥n principal
‚îÇ   ‚îî‚îÄ‚îÄ token.txt                   # Token de instalaci√≥n
‚îú‚îÄ‚îÄ logs\
‚îÇ   ‚îú‚îÄ‚îÄ agent.log                   # Logs principales
‚îÇ   ‚îú‚îÄ‚îÄ heartbeat.log               # Logs de heartbeat
‚îÇ   ‚îî‚îÄ‚îÄ scripts.log                 # Logs de ejecuci√≥n de scripts
‚îú‚îÄ‚îÄ data\
‚îÇ   ‚îú‚îÄ‚îÄ agent.db                    # Base de datos SQLite local
‚îÇ   ‚îî‚îÄ‚îÄ cache\                      # Cache de datos
‚îî‚îÄ‚îÄ scripts\
    ‚îú‚îÄ‚îÄ system_info.ps1             # Scripts de recolecci√≥n
    ‚îî‚îÄ‚îÄ health_check.ps1            # Scripts de verificaci√≥n
```

---

## **üöÄ PLAN DE IMPLEMENTACI√ìN**

### **üìÖ Fases de Desarrollo**

#### **Fase 1: Core y Registro (2-3 semanas)**
- ‚úÖ Estructura base del agente
- ‚úÖ M√≥dulo de registro con tokens
- ‚úÖ Comunicaci√≥n b√°sica con backend
- ‚úÖ Configuraci√≥n local
- ‚úÖ Logging b√°sico

#### **Fase 2: Monitoreo y Heartbeat (1-2 semanas)**
- ‚úÖ Recolecci√≥n de m√©tricas del sistema
- ‚úÖ Heartbeat peri√≥dico
- ‚úÖ Detecci√≥n de alertas b√°sicas
- ‚úÖ Env√≠o de logs al backend

#### **Fase 3: Ejecuci√≥n de Scripts (1-2 semanas)**
- ‚úÖ M√≥dulo de ejecuci√≥n de PowerShell
- ‚úÖ Sistema de comandos remotos
- ‚úÖ Timeout y control de procesos
- ‚úÖ Logs de ejecuci√≥n

#### **Fase 4: Funcionalidades Avanzadas (2-3 semanas)**
- ‚úÖ Auto-actualizaci√≥n del agente
- ‚úÖ Gesti√≥n de actualizaciones Windows
- ‚úÖ Integraci√≥n con RustDesk
- ‚úÖ Monitoreo predictivo

#### **Fase 5: Testing y Deployment (1-2 semanas)**
- ‚úÖ Testing exhaustivo
- ‚úÖ Instalador MSI
- ‚úÖ Documentaci√≥n de usuario
- ‚úÖ Deployment en producci√≥n

---

## **üñ±Ô∏è INTERFAZ DE USUARIO: SYSTEM TRAY**

### **üìã Men√∫ Contextual del Agente**

El agente incluye un **icono en la bandeja del sistema** (system tray) que permite a los usuarios finales interactuar f√°cilmente con el sistema de helpdesk.

```
üñ•Ô∏è LANET Agent (Icono en System Tray)
‚îú‚îÄ üü¢ Estado: Online - Cafe Mexico CDMX
‚îú‚îÄ üìä Ver Estado del Equipo
‚îú‚îÄ üé´ Reportar Problema ‚Üê FUNCIONALIDAD PRINCIPAL
‚îú‚îÄ üìã Mis Tickets (2 abiertos)
‚îú‚îÄ ‚öôÔ∏è Configuraci√≥n
‚îî‚îÄ ‚ùå Salir
```

### **üé´ Ventana "Reportar Problema"**

```
‚îå‚îÄ Reportar Problema - LANET Helpdesk ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                                                      ‚îÇ
‚îÇ üìù Describe el problema:                             ‚îÇ
‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ ‚îÇ Mi computadora est√° muy lenta desde esta ma√±ana  ‚îÇ ‚îÇ
‚îÇ ‚îÇ y se congela cuando abro Excel...                ‚îÇ ‚îÇ
‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îÇ                                                      ‚îÇ
‚îÇ üîß Categor√≠a: [Hardware ‚ñº]                          ‚îÇ
‚îÇ ‚ö° Prioridad: [Media ‚ñº]                              ‚îÇ
‚îÇ                                                      ‚îÇ
‚îÇ ‚úÖ Incluir informaci√≥n t√©cnica autom√°tica            ‚îÇ
‚îÇ ‚úÖ Incluir captura de pantalla                       ‚îÇ
‚îÇ                                                      ‚îÇ
‚îÇ üìä Informaci√≥n que se enviar√° autom√°ticamente:       ‚îÇ
‚îÇ ‚Ä¢ Equipo: DESKTOP-001 (Juan P√©rez)                  ‚îÇ
‚îÇ ‚Ä¢ Cliente: Cafe Mexico S.A. de C.V.                 ‚îÇ
‚îÇ ‚Ä¢ Sitio: Oficina Principal CDMX                     ‚îÇ
‚îÇ ‚Ä¢ CPU: 85% | RAM: 92% | Disco: 78%                  ‚îÇ
‚îÇ ‚Ä¢ IP: 192.168.1.100                                 ‚îÇ
‚îÇ ‚Ä¢ √öltima actualizaci√≥n: hace 2 minutos              ‚îÇ
‚îÇ                                                      ‚îÇ
‚îÇ                           [üé´ Crear Ticket]         ‚îÇ
‚îÇ                                                      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### **üìã Ventana "Mis Tickets"**

```
‚îå‚îÄ Mis Tickets - LANET Helpdesk ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                                                      ‚îÇ
‚îÇ üîç [Buscar tickets...                    ] [üîÑ]     ‚îÇ
‚îÇ                                                      ‚îÇ
‚îÇ üü° TKT-000456 - Computadora lenta                   ‚îÇ
‚îÇ    Creado: Hoy 14:30 | Estado: En progreso         ‚îÇ
‚îÇ    T√©cnico: Mar√≠a Gonz√°lez                          ‚îÇ
‚îÇ    Canal: üñ•Ô∏è Agente                                 ‚îÇ
‚îÇ    [üëÅÔ∏è Ver] [üí¨ Comentar]                          ‚îÇ
‚îÇ                                                      ‚îÇ
‚îÇ üü¢ TKT-000445 - Problema con impresora              ‚îÇ
‚îÇ    Creado: Ayer 09:15 | Estado: Resuelto           ‚îÇ
‚îÇ    T√©cnico: Carlos Ruiz                             ‚îÇ
‚îÇ    Canal: üåê Portal                                 ‚îÇ
‚îÇ    [üëÅÔ∏è Ver] [‚≠ê Calificar]                          ‚îÇ
‚îÇ                                                      ‚îÇ
‚îÇ üî¥ TKT-000432 - No puedo acceder al servidor        ‚îÇ
‚îÇ    Creado: 10/07/2025 | Estado: Cerrado            ‚îÇ
‚îÇ    T√©cnico: Ana L√≥pez                               ‚îÇ
‚îÇ    Canal: üìß Email                                  ‚îÇ
‚îÇ    [üëÅÔ∏è Ver] [üìã Historial]                         ‚îÇ
‚îÇ                                                      ‚îÇ
‚îÇ                              [üé´ Nuevo Ticket]      ‚îÇ
‚îÇ                                                      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### **üîß Implementaci√≥n T√©cnica del System Tray**

#### **Dependencias Adicionales:**
```python
# requirements.txt (agregar)
pystray>=0.19.4           # System tray icon
Pillow>=9.0.0             # Image handling
tkinter                   # GUI (incluido en Python)
plyer>=2.1                # Notificaciones del sistema
```

#### **Estructura de Archivos UI:**
```
src/ui/
‚îú‚îÄ‚îÄ system_tray.py        # Icono y men√∫ en system tray
‚îú‚îÄ‚îÄ ticket_window.py      # Ventana de creaci√≥n de tickets
‚îú‚îÄ‚îÄ status_window.py      # Ventana de estado del equipo
‚îú‚îÄ‚îÄ tickets_list.py       # Ventana de lista de tickets
‚îî‚îÄ‚îÄ assets/
    ‚îú‚îÄ‚îÄ lanet_icon.ico    # Icono del agente
    ‚îú‚îÄ‚îÄ online.ico        # Estado online
    ‚îú‚îÄ‚îÄ warning.ico       # Estado warning
    ‚îî‚îÄ‚îÄ offline.ico       # Estado offline
```

#### **Flujo de Creaci√≥n de Tickets:**
```python
# Ejemplo de implementaci√≥n
class TicketCreator:
    def create_ticket_from_agent(self, description, category, priority):
        ticket_data = {
            "description": description,
            "category": category,
            "priority": priority,
            "channel": "agente",  # ‚Üê NUEVO CANAL
            "auto_info": self.get_system_info(),
            "asset_id": self.agent.asset_id,
            "client_id": self.agent.client_id,
            "site_id": self.agent.site_id,
            "created_by_agent": True
        }

        response = self.api_client.post("/api/tickets/create-from-agent", ticket_data)
        return response
```

---

**√öltima actualizaci√≥n**: 15/07/2025
**Versi√≥n**: 1.1
**Estado**: ‚úÖ Especificaciones Completas + System Tray
